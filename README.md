# 智能导诊挂号系统

## 0. 前言

**智能导诊挂号系统**（下称 “本系统”）为一个辅助挂号系统，可为用户提供根据自身症状，推荐至挂号科室的功能。本项目由四人小组进行开发，并将该项目作为四人的毕业设计小组作品。

本系统的使用方式为：

1. 用户在系统中选择自身出现的症状。

2. 系统根据用户选择的症状，根据数据库中的**疾病症状对应表**，判断出所选症状可能对应的疾病。

3. 根据上一步判断出的疾病，提示出用户应该去到的挂号科室。

由于本系统仍在开发过程中，本博客预计一步步对其进行更新。其中，本人负责的部分为：数据库设计、疾病症状对应表的整理、UI设计、部分前端设计、后台设计。本博客侧重点也是本人所负责的部分，主要写一下其中觉得有趣的地方或者困扰一段时间的难点。

---



## 1. 核心算法——疾病症状对应表

- **需求确定阶段**

  ​        本系统的核心功能为根据用户选择的症状，为用户推荐一个科室。其中，系统需要先根据用户所选择的症状，判断出其可能出现的几种疾病，再根据疾病推荐至具体的科室。在此步骤中，根据症状判断可能的疾病是本系统的一个核心部分。

  ​        目前网上很难找到一个较为完整的疾病症状对应表，由于不同来源的数据往往主观性较大，**本小组决定自行整理出一份符合需求的疾病症状对应表。**

- **弯路**

  ​        实话实说一开始对于这个需求完全没有头绪，想过几种方法是根据ICD-10的疾病名称，爬虫获取百度百科上出现的症状。但其中并没有诸如“这一症状对判断这一疾病的重要性”之类的信息。显然不符合小组的需求。后续的想法则是，通过爬取知网每种疾病的前50篇或者100篇文章，对文章进行解析，查找其中某一个症状名出现在其中多少篇文章内，以这个数据正比反馈出这个症状对该疾病的重要性。虽然大概合理，但精确性还是太低，便只得继续思考。

- TF-IDF

  **在思考算法的时候，偶然接触到TF-IDF这一统计方法**

  > TF-IDF是一种统计方法，用以评估一字词对于一个文件集或一个语料库中的其中一份文件的重要程度。字词的重要性随着它在文件中出现的次数成正比增加，但同时会随着它在语料库中出现的频率成反比下降。
  >
  > ​																																										 ——百度百科

  这时灵感就来了，根据这一思想以及之前通过知网爬虫获取数据的思想，总结出了一个较为理想的方案：

  ![知网1](.\image\cnki01.png)

  ![](.\image\cnki02.png)

  这里先以两张图片举例说明TF值:

  > 图1 ：以主题为疾病名“鼠疫”， 全文包含“症状”一词，检索时间锁定为2021年2月1日之前，以此得到鼠疫疾病的研究热度1757
  >
  > 图2： 以主题为疾病名“鼠疫”， 全文包含“症状”一词，全文包含症状名“发热”，检索时间锁定为2021年2月1日之前，检索结果为636。
  >
  > **在提到鼠疫的症状的1757篇相关论文中，有636篇同时提及了发热一词，以此推出发热与鼠疫的关联系数TF为 636/1757 = 0.3620 **

  依常理判断，一个疾病的症状越典型，就会这个疾病相关的在更多的文章中被描述。**以此有合理推断，鼠疫与发热之间的关联关系与关系系数TF成正比，TF值越大则二者的关系越大**。这便是TF-IDF算法中的TF值，。

  那么TF-IDF剩下的IDF呢，下面我们再来对其进行计算。

  ![](.\image\cnki03.png)

  ![](.\image\cnki04.png)

  > 图3 以全文包含“症状”一词，全文包含症状名“发热”，检索时间锁定为2021年2月1日之前，获得同时包含症状以及症状名“发热”的文章为1020639，这里假设这些文章均为研究某一种疾病的文章，且在文章内出现了发热这一症状，**即出现发热症状的疾病文章总计有1020639篇**
  >
  > 图4以全文包含“症状”一词，检索时间锁定为2021年2月1日之前，获得包含症状一词的文章为6759842，这里假设这些文章均为研究疾病症状的文章，**即知网上一共有6759842篇文章在研究疾病症状**

  以常理来看，当发热这一症状是一个普遍发生的症状时，自然就会有更多的疾病在其症状中提及，反之，若某一症状为某一特定疾病所特有的标志症状，那么该症状在全部疾病的症状列表内提及数量自然就会少。**以此有合理推断：图3的结果/图4的结果，与该症状对于诊断一个疾病的重要程度成反比关系。**

  > **逆向文件频率**（inverse document frequency，IDF）是一个词语普遍重要性的度量。某一特定词语的IDF，可以由总文件数目除以包含该词语之文件的数目，再将得到的商取以10为底的[对数](https://baike.baidu.com/item/对数)得到

  这便是IDF的思想，不过IDF有另外的公式: 此处套用该公式得log（6759842/1020639）= 0.8210，这便是发热这一症状的IDF值。

  **分别得到了TF与IDF值，接下来简单将其相乘，便可得到发热这一症状与鼠疫这一疾病的TF-IDF权值，为0.2972**

  这里也附上一部分我整理出的疾病症状列表截图

  ![](.\image\TFIDF01.png)

  ![](.\image\TFIDF02.png)

  **所以，当患者查询某一系列疾病的时候，只需要查询数据库中相关的症状，将其权值相加，权值最高的疾病的概率就更高。**

  -----

  

- **爬虫**

  既然理清楚了算法，那就开始搞爬虫了。

  由于本系统准备以JAVA语言开发，所以爬虫部分我也采用JAVA的JSoup编写。知网在数据检索这方面并没有做过多的反爬虫处理，所以也是很轻松的就获取到了相关的数据。

  **至此，本系统的一个准备工作完成了。**

## 2. 其他功能

* **传染类疾病应该给予特殊提示**

  > 在分析出来的疾病中，传染类疾病的可能性较大时，提示 可能为具有传染性疾病，在前往医院过程中请与他人保持距离，并注意家人是否出现类似症状。

* **猝死类疾病应该提示急救AED位置，并提供120急救电话拨打**

  > 在用户选择症状包括猝死时，提示 若患者已无意识，请尽快寻找周边AED、并马上拨打急救120，并给出电话按钮

* **急救类疾病应该提供120急救电话拨打**

  > 在分析出来的疾病中，急救类的可能性较大时，提示 若患者情况危急，请直接拨打急救120，并给出电话按钮

* **若已有信息不足以判断疾病时**

  > 例如，患者选择症状“发热”以及“寒战”，系统通过检索数据库计算得，可能的疾病为鼠疫（0.5345）跟肺炎（0.5427），此处应该继续提示患者是否有其他症状，如提示患者是否包含鼠疫中TF-IDF值最高的几个症状，如，“斑疹”， “淋巴结肿大”。同理肺炎也是。























